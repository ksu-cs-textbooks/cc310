




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		
		
		

	
	
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="CC 310 Textbook">
    <meta name="author" content="Russell Feldhausen">
    <title>Singly Linked Lists - Insertion :: CC 310 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cc310/9-lists/5-singly-linked-lists-insertion/index.html" rel="canonical" type="text/html" title="Singly Linked Lists - Insertion :: CC 310 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc310/9-lists/5-singly-linked-lists-insertion/index.xml" rel="alternate" type="application/rss+xml" title="Singly Linked Lists - Insertion :: CC 310 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc310/9-lists/5-singly-linked-lists-insertion/index.print.html" rel="alternate" type="text/html" title="Singly Linked Lists - Insertion :: CC 310 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cc310/9-lists/5-singly-linked-lists-insertion/embed.html" rel="alternate" type="text/html" title="Singly Linked Lists - Insertion :: CC 310 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/fontawesome-all.min.css?1691781778" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc310/css/fontawesome-all.min.css?1691781778" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/nucleus.css?1691781778" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/auto-complete.css?1691781778" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc310/css/auto-complete.css?1691781778" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/perfect-scrollbar.min.css?1691781778" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/fonts.css?1691781778" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cc310/css/fonts.css?1691781778" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/theme.css?1691781778" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/theme-auto.css?1691781778" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/variant.css?1691781778" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/print.css?1691781778" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/ie.css?1691781778" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/url.js?1691781778"></script>
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/variant.js?1691781778"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cc310/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cc310/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cc310/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cc310/css/custom.css?1691781778" rel="stylesheet">

  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cc310/9-lists/5-singly-linked-lists-insertion/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="singly-linked-lists---insertion">Singly Linked Lists - Insertion</h1>

<p><a href="https://www.youtube.com/watch?v=2TVtKD6jvQw">YouTube Video</a></p>
<p>Given the structure of our linked list, we can easily insert a new node at any location in the list. However, for our purposes we are generally interested in inserting new nodes at the beginning of the list, at some specific location in the list, or in the appropriate order if the list is sorted.</p>
<h2 id="inserting-at-the-beginning">Inserting at the Beginning</h2>
<p>Inserting a node at the beginning of a list is straightforward. We just have to be careful about the order we use when swapping pointers. In the <code>prepend</code> code below, line 1 creates the new node to be stored in the list. Next, line 2 assigns the pointer in the new node to point to the pointer held by the <code>head</code>. If there was an item already in the list, <code>head</code> will point to the previous first item in the list. If the list was empty, <code>head</code> will have been <code>null</code> and thus the <code>node.next</code> will become <code>null</code> as well. Line 3 assigns <code>head</code> to point to the new node and line 4 increments our size variable.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span>function prepend(data)
</span></span><span style="display:flex;"><span>    node = new Node(data)	(1) 
</span></span><span style="display:flex;"><span>	node.next = head 	    (2)
</span></span><span style="display:flex;"><span>	head = node			    (3)
</span></span><span style="display:flex;"><span>	size = size + 1		    (4)
</span></span><span style="display:flex;"><span>end function</span></span></code></pre></div><p>We show this process in the following example. The figure below shows the initial state as we enter the <code>prepend</code> operation. Our list has three items in it, an &ldquo;a&rdquo;, &ldquo;W&rdquo;, and &ldquo;Q&rdquo; and we want to add the new node &ldquo;M&rdquo; in front of item &ldquo;a&rdquo;.</p>
<p>
<a href="#image-e284dca3dcbee4feaf4b12b390f7cdf3" class="lightbox-link">
<img src="../../images/9/9.5.singleinsert1.png" alt="Singly Linked List Prepend 1" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-e284dca3dcbee4feaf4b12b390f7cdf3">
<img src="../../images/9/9.5.singleinsert1.png" alt="Singly Linked List Prepend 1" class="lightbox-image" loading="lazy">
</a></p>
<p>The figure below shows the effect of the first step of the operation. This step creates a new node for &ldquo;M&rdquo; and changes <code>next</code> to point at the same node as the pointer held by <code>head</code>, which is the address of the first item in the list, &ldquo;a&rdquo;.</p>
<p>
<a href="#image-a5cad5b119230c727e46ac70cfc900a8" class="lightbox-link">
<img src="../../images/9/9.5.singleinsert2.png" alt="Singly Linked List Prepend 2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a5cad5b119230c727e46ac70cfc900a8">
<img src="../../images/9/9.5.singleinsert2.png" alt="Singly Linked List Prepend 2" class="lightbox-image" loading="lazy">
</a></p>
<p>The result of performing line 3 in the operation is shown below. In line 3 we simply change <code>head</code> to point to our new node, instead of node &ldquo;a&rdquo;. Notice now that the new node has been fully inserted into the list.</p>
<p>
<a href="#image-e80533492b51d55ebdcd5b6444ac3400" class="lightbox-link">
<img src="../../images/9/9.5.singleinsert3.png" alt="Singly Linked List Prepend 3" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-e80533492b51d55ebdcd5b6444ac3400">
<img src="../../images/9/9.5.singleinsert3.png" alt="Singly Linked List Prepend 3" class="lightbox-image" loading="lazy">
</a></p>
<p>And, if we redraw our diagram a bit, we get a nice neat list!</p>
<p>
<a href="#image-37a88eeaceebcbfc8e2f7f30bfa96d8c" class="lightbox-link">
<img src="../../images/9/9.5.singleinsert4.png" alt="Singly Linked List Prepend 4" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-37a88eeaceebcbfc8e2f7f30bfa96d8c">
<img src="../../images/9/9.5.singleinsert4.png" alt="Singly Linked List Prepend 4" class="lightbox-image" loading="lazy">
</a></p>
<p>Since there are no loops in the <code>prepend</code> operation, <code>prepend</code> runs in constant time.</p>
<h2 id="inserting-in-the-middle">Inserting in the Middle</h2>
<p>Inserting a node at a given index in the linked list is a little more difficult than inserting a node at the beginning of the list. First, we have to find the proper location to insert the new node before we can actually insert it. However, since we are given an index number, we simply need to follow the linked list to the appropriate index and then perform the insertion.</p>
<p>We do have a precondition to meet before we proceed, however. We need to make sure that the index provided to the operation is not less than 0 and that it is not greater than the size of the list, which is checked in line 2. If the precondition is not satisfied, we raise an exception in line 3.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span>function insertAt(data, index)	        (1)
</span></span><span style="display:flex;"><span>		if index &lt; 0 or index &gt; size	(2)
</span></span><span style="display:flex;"><span>			raise exception	            (3)
</span></span><span style="display:flex;"><span>		elseif index == 0	            (4)
</span></span><span style="display:flex;"><span>			prepend(data)		        (5)
</span></span><span style="display:flex;"><span>		else
</span></span><span style="display:flex;"><span>			curr = head.next	        (6)
</span></span><span style="display:flex;"><span>			prev = head		            (7)
</span></span><span style="display:flex;"><span>			node = new Node(data)	    (8)
</span></span><span style="display:flex;"><span>		for i = 1 to index – 1	        (9)
</span></span><span style="display:flex;"><span>			prev = curr	                (10)
</span></span><span style="display:flex;"><span>			curr = curr.next	        (11)
</span></span><span style="display:flex;"><span>		end for			                (12)
</span></span><span style="display:flex;"><span>		prev.next = node	            (13)
</span></span><span style="display:flex;"><span>		node.next = curr	            (14)
</span></span><span style="display:flex;"><span>		size = size + 1	                (15)
</span></span><span style="display:flex;"><span>	end if
</span></span><span style="display:flex;"><span>end function</span></span></code></pre></div><p>Lines 4 and 5 check to see if the <code>index</code> is 0, which means that we want to insert it as the first item in the list. Since this is the same as the <code>prepend</code> operation we&rsquo;ve already defined, we simply call that operation. While this may not seem like a big deal, it is actually more efficient and helps us to simplify the code in the rest of the operation.</p>
<p>The operation uses <code>curr</code> to keep track of which node in the list we are currently looking at, thus we initialize <code>curr</code> to point at the first node in the list in line 6.  To allow us to swap pointers once we find the appropriate place in the list, we keep track of the node previous to <code>curr</code> as well by using the variable <code>pre</code>. This variable is initialized to <code>head</code> in line 7, and line 8 creates the new node we will insert into our list. After line 8, our <code>list</code>, <code>node</code>, and <code>previous</code> pointers would look like the following (assuming the index passed in was <code>2</code>).</p>
<p>
<a href="#image-4cf712ce5b217fe8518e81ca6354bb42" class="lightbox-link">
<img src="../../images/9/9.5.insertat1.png" alt="Singly Linked List Insert 1" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-4cf712ce5b217fe8518e81ca6354bb42">
<img src="../../images/9/9.5.insertat1.png" alt="Singly Linked List Insert 1" class="lightbox-image" loading="lazy">
</a></p>
<p>At this point we start our walk through the list using the <code>for</code> loop in lines 9 - 12. Specifically, with an <code>index</code> of 2 we will actually go through the loop exactly one time, from <code>1 to 1</code>. Each time through the loop, lines 10 and 11 will cause <code>curr</code> and <code>prev</code> to point at the next nodes in the list. At the end of one time through our loop, our example will be as shown below.</p>
<p>
<a href="#image-608b983331bfc0485b485b65de258223" class="lightbox-link">
<img src="../../images/9/9.5.insertat2.png" alt="Singly Linked List Insert 2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-608b983331bfc0485b485b65de258223">
<img src="../../images/9/9.5.insertat2.png" alt="Singly Linked List Insert 2" class="lightbox-image" loading="lazy">
</a></p>
<p>Now, the only thing left to do is update the <code>next</code> pointer of node &ldquo;3&rdquo; to point at <code>node</code> (line 13), and <code>node.next</code> to point at <code>curr</code> node (line 14), while line 15 increments the size attribute. The updated list is shown below.</p>
<p>
<a href="#image-c3b1ffc2f8585f1eea9e21b34edabe02" class="lightbox-link">
<img src="../../images/9/9.5.insertat3.png" alt="Singly Linked List Insert 3" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-c3b1ffc2f8585f1eea9e21b34edabe02">
<img src="../../images/9/9.5.insertat3.png" alt="Singly Linked List Insert 3" class="lightbox-image" loading="lazy">
</a></p>
<p>The <code>insertAt</code> operation, while being quite flexible and useful, can potentially loop through each node in the list. Therefore, it runs in order $N$ time.</p>
<h2 id="inserting-in-order">Inserting in Order</h2>
<p>When we want to insert an item into an ordered list, we need to find the right place in the list to actually insert the new node. Essentially, we need to search the list to find two adjacent nodes where the first node&rsquo;s data is less than or equal to <code>data</code> and the second node&rsquo;s data is greater than <code>data</code>. This process requires a linear search of the list.</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span>function insertOrdered(data) 
</span></span><span style="display:flex;"><span>		curr = head			                (1)
</span></span><span style="display:flex;"><span>	index = 0				                (2)
</span></span><span style="display:flex;"><span>	while curr != NULL AND curr.data &lt; data	(3) 
</span></span><span style="display:flex;"><span>		index = index + 1	                (4)
</span></span><span style="display:flex;"><span>		curr = curr.next	                (5)
</span></span><span style="display:flex;"><span>	end while
</span></span><span style="display:flex;"><span>	insertAt(data, index)	                (6)
</span></span><span style="display:flex;"><span>end function</span></span></code></pre></div><p>Notice that we do not have a precondition since we will search the list for the appropriate place to insert the new node, even if the list is currently empty. In line 1, we create a <code>curr</code> variable to point to the current node we are checking in the list, while in line 2 we initialize an <code>index</code> variable to keep track of the index of <code>curr</code> in the list.</p>
<p>Next, lines 3 – 5 implement a loop that searches through the list to find a node where the data in that node is greater than or equal to the data we are trying to put into the list. We also check to see if we are at the end of the list. Inside the loop, we increment <code>index</code> and point <code>curr</code> to the next node in the list.</p>
<p>Once we find the appropriate place in the list, we simply call the <code>insertAt</code> operation to perform the actual insertion. Using the <code>insertAt</code> operation provides a nice, easy to understand operation. However, we do suffer a little in efficiency since both operations loop through the list to the location where we want to insert the new data node. However, since the <code>insertAt</code> call is not embedded within the loop, our <code>insertOrdered</code> operation still runs in order $N$ time.</p>
<p>Since the previous example inserts the number 2 into the list (which falls between -1 and 3), the results of running the <code>insertOrdered</code> operation will be the same output as the result of the <code>insertAt</code> operation as shown above.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    </div>
    
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/clipboard.min.js?1691781780" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/perfect-scrollbar.min.js?1691781780" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/theme.js?1691781780" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cc310/js/tele-scroll.js?1691781780 defer"></script>
    
  </body>
</html>
